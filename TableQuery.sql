




/*Insert Record for Customer Table */
Insert Into Customer
(CustomerID,First_name,Last_name ,Password,Phone,Driver_License,Card_number ,Card_type,Minit ,Street ,State,City ,ZipCode)
Values
(202200,'Muhammad','Putra','putra1234','82541342','734575914','929311459794989','Visa','Nuhsyah','758NorthwestBoulevard','DC','Washington',20510),
(202201,'Ethen','son','john1234','2025550173','819611294','716648627003109','Visa','John','2855 Clifford Street','CA','San Francisco',94124),
(202202,'Abbatiello','Lyla','lyla1234','2025550112','803701716','755258193931899','Visa','Nicole','1990 Hornor Avenue','OK','Tulsa',74120),
(202203,'Cynthia','Blocker','Blocker1234','9164631858','C9851256','5283181970721085','MasterCard','K','4246 Park Avenue','CA','Fair Oaks',95628),
(202204,'Kylia','Abbott','abbott1234','3522199956','M520422811640 ','4532011262297795','Visa','Elizabeth','1216 Long Street','FL','Ocala',34471),
(202205,'Chad','Thompson','Thompson1234','4048479355','017586461','5474429995678999','MasterCard','M','2947 Stroop Hill Road','GA',' Atlanta',30342),
(202206,'Sean ','Major','Major1234','9514523804','5ZHG772','5229699275322058','MasterCard','M ','2682 Denver Avenue','CA','Anaheim',92801),
(202207,'Max ','Piper','Piper1234','3019856775','4MD4227','5274772682352119','MasterCard','J','4942 Lake Floyd Circle','MD','Hyattsville',20781),
(202208,'Madelyn ','Stephens','Stephens1234','9145485410','7AVM563','4539743066099810','Visa','D','2397 Mount Tabor','NY','New York',10007),
(202209,'Richard ','Poston','Poston1234','4142981538','2MD2756','5109936467527788','MasterCard','P','3879 Johnny Lane','WI','Milwaukee',53202),
(202210,'Diana','Dickerson','Dickerson1234','6018582670','230455085','5452524238694898','MasterCard','A','1745 Devils Hill Road','MS','Georgetown',39078),
(202211,'Victor ','Burke','Burke1234','2678400791','6FKP67','4916348936552361','Visa','C','1394 Linda Street','PA','Newark',19714),
(202212,'Ramon','Peiffer','Peiffer1234','2028725548','7833977','5356741821323993','MasterCard','P ','4955 School Street','DC','Washington',20036),
(202213,'James','Smith','Smith1234','8127366805','7817479320','4716564011758937','Visa','M','3639 Heliport Loop','IN',' Corydon',47112),
(202214,'Priscilla','Young','Young1234','5123433182','40529429','5323658086785163','MasterCard','T','1115 Bubby Drive','TX','Austin',78759),
(202215,'Florence','James','James1234','4794260029','458459192','5461540658034125','MasterCard','D','2088 Green Hill Road','AR','Fort Smith',72908),
(202216,'David','McDaniel','McDaniel1234','4195578897','NI572048','5123527353236584','MasterCard','B ','4967 Stonecoal Road','OH','Toledo',43609),
(202217,'Tommy','Griffith','Griffith1234','9175451272','794202311 ','4929687687336846','Visa','N','2432 Duncan Avenue','NY',' New York',10007),
(202218,'Sylvia','Traub','Traub1234','6068267040','S16891260','5515077335965815','MasterCard','A ','1051 North Bend River Road','KY',' Lexington',40507),
(202219,'James','Robinson','Robinson1234','2565850712','2240049','5314014914801494','MasterCard','M ','2345 Marcus Street','AL',' Huntsville',35816),
(202220,'Joanne','Greene','Greene1234','2767380081','224417450','5213059873204844','MasterCard','D ','3340 Payne Street','VA',' Dickensonville',24283),
(202221,'John ','Harris','Harris1234','9067438672','S530579188188','4916583085347979','Visa','T','3475 Pinewood Avenue','MI',' Marquette',49855),
(202222,'Robert ','Lanier','Lanier1234','8174097672','31572108','5435436132405184','MasterCard','R','1299 Waldeck Street','TX',' Fort Worth',76102),
(202223,'Erin ','Lawson','Lawson1234','8592697628','Y15569124','4916586225070203','Visa','O ','2730 Carson Street','KY','Lexington',40502),
(202224,'Mark ','Reece','Reece1234','6199034169','S5242994','5476632498534357','MasterCard','T','3045 Ocello Street','CA',' San Diego',92103),
(202225,'Lori','Montalvo','Montalvo1234','4079090376','W436625910060','5204267445923855','MasterCard','W','3606 McDonald Avenue','FL','Windermere',34786),
(202226,'Nina ','Allen','Allen1234','4846159278','63475582','5442641438641868','MasterCard','R ','3205 Franklee Lane','PA','Philadelphia',19107),
(202227,'Mary ','Bullock','Bullock1234','6092076183','G20157194885799','5410691398521228','MasterCard','R','2217 Dark Hollow Road','NJ','Beach Haven',08008),
(202228,'Russell','Tyndall','Tyndall1234','5868840948','S530333232638','4916474647700238','Visa','S','2571 Reppert Coal Road','MI',' Detroit',48226),
(202229,'Beverly ','Renteria','Renteria1234','7207475854','762483773','4916198196487174','Visa','M ','1494 Clay Lick Road','CO',' Denver',80014),
(202230,'Larry','Friedman','Friedman1234','2623729145','B6345018863300','5121545096909228','MasterCard','S','488 Oakridge Farm Lane','WI',' Milwaukee',53212),
(202231,'Charles ','Poovey','Poovey1234','8322935978','44675514','5104442744186352','MasterCard','R ','2637 Wines Lane','TX',' Houston',77032),
(202232,'William ','Blaylock','Blaylock1234','4077014459','H430512812150','5297940911019972','Visa','C ','3848 Grand Avenue','FL',' Orlando',32805),
(202233,'Carl','Poole','Poole1234','8652187406','405825000','4716831432471535','Visa','G','4733 Brown Avenue','TN',' Knoxville',37933),
(202234,'Maria ','Young','Young1234','2199773916','4039575302','4539842133344488','Visa','T','3288 Jadewood Drive','IN',' Gary',46404),
(202235,'Richard','McLemore','McLemore1234','2397916808','F460424856260','5376660385972134','MasterCard','S ','3589 Village View Drive','FL',' Fort Myers',33901),
(202236,'Patrick ','Lane','Lane1234','3015561961','M624123614471','5164893408065455','MasterCard','L ','441 Doe Meadow Drive','MD',' Washington',20004)





/*Insert record for Catalog */
Insert Into Catalog
(Catalog_id,chargeperday,imageurl)
Values
(00001,2.50,'ironman.jpg'),
(00002,2.50,'Morbius.jpg'),
(00003,2.50,'TheGodfather.jpg'),
(00004,2.50,'Dark Knight.jpg'),
(00005,2.50,'Inception.jpg'),
(00006,2.50,'Matrix.jpg'),
(00007,2.50,'Interstellar.jpg'),
(00008,2.50,'Spider-Man.jpg'),
(00009,2.50,'Avengers.jpg'),
(00010,2.50,'ToyStory3.jpg'),
(00011,2.50,'PercyJackson.jpg'),
(00012,2.50,'TopGun.jpg'),
(00013,2.50,'Thor.jpg'),
(00014,2.50,'Winnie-The-Pooh.jpg'),
(00015,2.50,'CentralIntelligence.jpg'),
(00016,2.50,'HowtoTrainYourDragon2.jpg'),
(00017,2.50,'Godzilla.jpg'),
(00018,2.50,'Spider-Man.jpg'),
(00019,2.50,'Pokemon.jpg'),
(00020,2.50,'EnolaHolmes.jpg'),
(10001,2.50,'Toshiba.jpg'),
(10002,2.50,'Panasonic.jpg'),
(10003,2.50,'Goshyda.jpg'),
(10004,2.50,'Canon.jpg'),
(10005,2.50,'JVC.jpg'),
(10006,2.50,'Sharp.jpg'),
(10007,2.50,'Sony.jpg'),
(10008,2.50,'RCA.jpg'),
(20001,2.50,'Sony.jpg'),
(20002,2.50,'Panasonic.jpg'),
(20003,2.50,'Canon.jpg'),
(20004,2.50,'JVC.jpg'),
(20005,2.50,'Logitech.jpg'),
(20006,2.50,'GoPro.jpg'),
(20007,2.50,'Dji.jpg'),
(20008,2.50,'Akaso.jpg'),
(20009,2.50,'Kodak.jpg'),
(20010,2.50,'samsung.jpg')






/*Insert record for Employee */
Insert Into Employee
(Employee_id,First_name,Last_name,minit,street,city,state,zipcode,country,title,paytype,payrate,storeID)
values
(100,'CHIN','YEN','','756 Peaceful Lane','Warrensville Heights','OH',44128,'usa','Mr','partTime',1200.50,2200),
(101,'Glen','Johnson','','2440 Circle Drive','Houston','TX',77032,'usa','Mr','partTime',950.50,2201),
(102,'Kathy','Welch','','1083 Owagner Lane','Seattle','WA',98101,'usa','Mrs','partTime',1100.50,2202),
(103,'April','Kimble','','1000 Saint James Drive','Mifflintown','PA',17059,'usa','Mrs','partTime',1500.50,2203),
(104,'Joyce','Clark','','2327 Conifer Drive',' Tukwila','WA',98188,'usa','Mrs','partTime',1300.50,2204),
(105,'Jim ','Edmond','','3809 Stratford Drive','Honolulu','HI',96813,'usa','Mr','partTime',850.50,2205),
(106,'Maureen ','Borges','','3390 Alpha Avenue','Jacksonville','FL',32202,'usa','Mrs','assistantManager',2100.50,2200),
(107,'Joshua ','Rencher','','385 Bassell Avenue','Little Rock','AR',72211,'usa','Mr','assistantManager',1900.50,2201),
(108,'Kim  ','Vinson','','1019 Sherman Street','Salina','KS',67401,'usa','Mrs','assistantManager',2500.50,2202),
(109,'Tracy ','James','','1991 Melrose Street',' Millwood','WA',99212,'usa','Mr','assistantManager',2750.50,2203),
(110,'Donald ','Larsen','','96 Anmoore Road',' Bronx','NY',10453,'usa','Mr','assistantManager',2300.50,2204),
(111,'Elizabeth ','Weathers','','4641 Richison Drive','Reedpoint','MT',59069,'usa','Mrs','assistantManager',2200.50,2205),
(112,'Donald','Hiser','','4649 Valley Lane','Austin','TX',78701,'usa','Mr','manager',2850.50,2200),
(113,'Crystal','Schumacher','','2145 Anmoore Road',' Brooklyn','NY',11213,'usa','Mrs','manager',2650.50,2201),
(114,'Lola','Valentine','','3513 Luke Lane',' Stillwater','OK',74074,'usa','Mrs','manager',3000.50,2202),
(115,'John','Flores','','773 Fannie Street','Bryan','TX',77803,'usa','Mr','manager',2050.50,2203),
(116,'Theodore ','Basham','','1129 Olen Thomas Drive',' Bridgeport','TX',76026,'usa','Mr','manager',3200.50,2204),
(117,'William ','Falcon','','1812 Murry Street',' Virginia Beach','VA',23454,'usa','Mr','manager',3050.50,2205)



 


/*Insert record for Store */
Insert Into Store
(Store_ID,Location,Street,State,City,ZipCode)
values
(2200,'Downtown Seattle','500 Pine Street','Wa','Seattle',98101),
(2201,'Southcenter Square Rack','17200 Southcenter Parkway, Suite 110','Wa','Tukwila,',98188),
(2202,'Anchorage Rack','680 E Northern Lights Boulevard ','AK','Anchorage',99503),
(2203,'Downtown Portland','701 SW Broadway ','OR','Portland',97205),
(2204,'Sugarhouse Rack','2210 S 1300 East','UT','Salt Lake City',84106),
(2205,'Park Meadows','8465 Park Meadows Center Drive','CO','Lone Tree',80124)





/* Insert record for Item */
Insert Into Item
(Catalog_id,COPY_ID)
values
(00001,00001),
(00002,00002),
(00003,00003),
(00004,00004),
(00005,00005),
(00006,00006),
(00007,00007),
(00008,00008),
(00009,00009),
(00010,00010),
(00011,00011),
(00012,00012),
(00013,00013),
(00014,00014),
(00015,00015),
(00016,00016),
(00017,00017),
(00018,00018),
(00019,00019),
(00020,00020),
(10001,10001),
(10002,10002),
(10003,10003),
(10004,10004),
(10005,10005),
(10006,10006),
(10007,10007),
(10008,10008),
(20001,20001),
(20002,20002),
(20003,20003),
(20004,20004),
(20005,20005),
(20006,20006),
(20007,20007),
(20008,20008),
(20009,20009),
(20010,20010)



/*Insert record for movie */
Insert Into movie
(Catalog_id,Movie_name,director,producer,Actor,Actor2)
values
(00001,'Ironman','Jon Favreau','Avi Arad','Robert Downey Jr.','Scarlett Johansson'),
(00002,'Morbius','Daniel Espinosa','Lucas Foster','Jared Leto','Matt Smith'),
(00003,'The Godfather','Francis Ford Coppola','Albert S. Ruddy','Marlon Brando','Robert Duvall'),
(00004,'The Dark Knight','Christopher Nolan','Charles Roven','Christian Bale','Heath Ledger'),
(00005,'Inception','Christopher Nolan','Emma Thomas','Leonardo DiCaprio','Tom Hardy'),
(00006,'The Matrix','Lilly Wachowski','Silver Pictures','Keanu Reeves','Carrie-Anne Moss'),
(00007,'Interstellar','Christopher Nolan','Lynda Obst','Matthew McConaughey','Anne Hathaway'),
(00008,'Spider-Man: Into the Spider-Verse','Daniel Espinosa','Phil Lord','Jake Johnson','Shameik Moore'),
(00009,'Avengers: Endgame','Joe Russo','Kevin Feige','Robert Downey Jr.','Chris Evans'),
(00010,'Toy Story 3','Lee Unkrich','Darla K. Anderson','Tom Hanks','Tim Allen'),
(00011,'Percy Jackson and the Lightning Thief','Chris Columbus','Michael Barnathan','Logan Lerman','Alexandra Daddario'),
(00012,'Top Gun: Maverick','Joseph Kosinski','Tom Cruise','Val Kilmer','Miles Teller'),
(00013,'Thor: Love and Thunder','Taika Waititi','Kevin Feige','Christian Bale','Natalie Portman'),
(00014,'Winnie-The-Pooh: Blood and Honey','Rhys Waterfield','Scott Jeffrey','Amber Doig-Thorne','Maria Taylor'),
(00015,'Central Intelligence','Rawson Marshall Thurber','Scott Stuber','Kevin Hart','Dwayne Johnson'),
(00016,'How to Train Your Dragon 2','Dean DeBlois','Bonnie Arnold','Jay Baruchel','Cate Blanchett'),
(00017,'Godzilla:King of the Monsters','Micheal Dougherty','Legendary Entertainment','Kyle Chandler','Vera Farmiga'),
(00018,'Spider-Man:Homecoming','Jon Watts','Kevin Feige','Tom Holland','Micheal Keaton'),
(00019,'Pokemon Detective Pikachu','Rob Letterman','Mary Parent','Ryan Reynolds','Justice Smith'),
(00020,'Enola Holmes','Harry Bradbeer','PCMA Productions','Millie Bobby Brown','Henry Cavill')








/*Insert record for VCR */
Insert into VCR
(Catalog_id,Type,VCR_brand,madeBy,purchasedDate)
values
(10001,'Toshiba','Toshiba','japan','2022-06-20'),
(10002,'Panasonic','Panasonic','japan','2022-05-21'),
(10003,'Goshyda','Goshyda','china','2022-04-22'),
(10004,'Canon','Canon','japan','2022-03-23'),
(10005,'JVC','JVC','japan','2022-02-24'),
(10006,'Sharp','Sharp ','japan','2022-01-25'),
(10007,'Sony','Sony','japan','2022-07-26'),
(10008,'RCA ','RCA ','usa','2022-08-27')





/*Insert record for videoCamera */

Insert into VideoCamera 
(Catalog_id,Video_camera_brand,madeBy,purchasedDate)
values
(20001,'sony','Japan','2022-05-28'),
(20002,'Panasonic','Japan','2022-04-27'),
(20003,'Canon','japan','2022-03-26'),
(20004,'JVC','japan','2022-02-25'),
(20005,'Logitech','china','2022-01-24'),
(20006,'GoPro','china','2022-06-23'),
(20007,'Dji','china','2022-07-22'),
(20008,'Akaso','china','2022-08-21'),
(20009,'Kodak','usa','2022-09-20'),
(20010,'samsung','south korea','2022-10-15')





/*Insert record for transaction */
Insert into Transaction_tab 
(Transaction_ID,Transaction_Type,Customer_ID,Transaction_Date,Due_date,return_date,rental_charge,penalty_Charge,TotalCharge,Store_ID)
values 
(21001,'reserve',202200,'2021-01-29','','',0,0,0,2200),
(21002,'rent',202201,'2021-10-28','2022-01-06','2021-11-08',27.50,0,27.50,2200),
(21003,'reserve',202202,'2021-02-28','','',0,0,0,2201),
(21004,'rent',202203,'2021-11-27','2022-02-07','2021-12-10',32.50,0,32.50,2202),
(21005,'reserve',202204,'2021-03-27','','',0,0,0,2200),
(21006,'rent',202205,'2021-12-26','2022-03-29','2022-04-01',232.50,1.50,234.00,2202),
(21007,'reserve',202206,'2021-04-26','','',0,0,0,2203),
(21008,'rent',202207,'2021-09-25','2022-04-08','2021-10-10',37.50,0,37.50,2203),
(21009,'reserve',202208,'2021-05-25','','',0,0,0,2204),
(21010,'rent',202209,'2021-08-24','2022-05-09','2021-09-11',45.00,0,45.00,2200),
(21011,'reserve',202210,'2021-06-24','','',0,0,0,2201),
(21012,'rent',202211,'2021-07-23','2022-06-28','2022-07-02',860.00,2.00,872.00,2202),
(21013,'reserve',202212,'2021-07-23','','',0,0,0,2203),
(21014,'rent',202213,'2021-08-22','2022-07-28','2021-09-12',30.00,0,30.00,2203),
(21015,'reserve',202214,'2021-08-22','','',0,0,0,2202),
(21016,'rent',202215,'2021-09-09','2022-08-10','2021-10-02',57.50,0,57.50,2205),
(21017,'reserve',202216,'2021-09-21','','',0,0,0,2205),
(21018,'rent',202217,'2021-10-20','2022-09-27','2022-12-25',855.00,44.50,899.50,2204),
(21019,'reserve',202218,'2021-10-20','','',0,0,0,2202),
(21020,'rent',202219,'2021-11-21','2022-01-20','2021-12-15',60.00,0,60.0,2204),
(21021,'reserve',202220,'2021-11-19','','',0,0,0,2203),
(21022,'rent',202221,'2021-12-18','2022-02-20','2022-01-15',70.0,0,70.0,2202),
(21023,'reserve',202222,'2021-12-18','','',0,0,0,2201),
(21024,'rent',202223,'2022-01-17','2022-03-30','2022-02-15',72.50,0,72.50,2200),
(21025,'rent',202224,'2022-02-16','2022-04-28','2022-03-19',77.50,0,77.50,2202),
(21026,'rent',202225,'2022-03-15','2022-05-27','2022-06-17',182.50,31.50,214.00,2203),
(21027,'rent',202226,'2022-04-14','2022-06-26','2022-04-30',40.00,0,40.00,2204),
(21028,'rent',202227,'2022-05-13','2022-07-25','2022-05-31',45.00,0,45.00,2202),
(21029,'rent',202228,'2022-06-12','2022-08-24','2022-07-29',117.50,0,117.50,2203),
(21030,'rent',202229,'2022-07-11','2022-09-23','2022-08-28',120.00,0,12.00,2201),
(21031,'rent',202230,'2022-08-10','2022-10-22','2022-09-29',125.00,0,125.00,2202),
(21032,'rent',202231,'2022-09-09','2022-11-21','2022-10-27',127.50,0,127.50,2205),
(21033,'rent',202232,'2022-10-08','2022-12-20','2022-11-26',122.50,0,122.50,2204),
(21034,'rent',202233,'2022-11-07','2022-12-31','2022-11-30',57.50,0,57.50,2202),
(21035,'rent',202234,'2022-12-06','2022-12-30','2022-12-27',52.50,0,52.50,2204),
(21036,'rent',202235,'2022-12-10','2023-01-10','2023-02-12',77.50,49.50,127.00,2203),
(21037,'rent',202236,'2023-01-10','2023-02-28','2023-02-10',77.50,0,77.50,2202),
(21038,'rent',202236,'2023-02-09','2023-03-30','2023-02-28',47.50,0,47.50,2201)





/*Insert record for transactionItem */
Insert into TransactionItem
(Catalog_id,Transaction_ID,COPY_ID)
values
(00001,21001,00001),
(00002,21002,00002),
(00003,21003,00003),
(00004,21004,00004),
(00005,21005,00005),
(00006,21006,00006),
(00007,21007,00007),
(00008,21008,00008),
(00009,21009,00009),
(00010,21010,00010),
(00011,21011,00011),
(00012,21012,00012),
(00013,21013,00013),
(00014,21014,00014),
(00015,21015,00015),
(00016,21016,00016),
(00017,21017,00017),
(00018,21018,00018),
(00019,21019,00019),
(00020,21020,00020),
(10001,21021,10001),
(10002,21022,10002),
(10003,21023,10003),
(10004,21024,10004),
(10005,21025,10005),
(10006,21026,10006),
(10007,21027,10007),
(10008,21028,10008),
(20001,21029,20001),
(20002,21030,20002),
(20003,21031,20003),
(20004,21032,20004),
(20005,21033,20005),
(20006,21034,20006),
(20007,21035,20007),
(20008,21036,20008),
(20009,21037,20009),
(20010,21038,20010)


/*List of select Statement for each table  */
select * From Customer;
select * From Catalog;
select * From Employee;
select * From Store;
select * From Item;
select * From movie;
select * From VCR;
select * From VideoCamera;
select * From Transaction_tab;
select * From TransactionItem;


/*list of SQL statement for each query(1-6) */

/* Query 1 (View total number of outgoing movies per store and per month.) */


select t.Store_ID,count(ti.Transaction_ID)'Total number of outgoing movies',m.Movie_name,DATENAME(month,Transaction_Date)'Month',Year(Transaction_Date)'Year',m.Catalog_id
from Transaction_tab t
JOIN TransactionItem ti
ON t.Transaction_ID=ti.Transaction_ID
JOIN movie m
ON ti.Catalog_id=m.Catalog_id
where Transaction_Type='rent'
GROUP by Month(t.Transaction_Date),t.Store_ID,DATENAME(month,Transaction_Date),Year(Transaction_Date),m.Movie_name,m.Catalog_id
order by t.Store_ID,Year(Transaction_Date),DATENAME(month,Transaction_Date),m.Movie_name,m.Catalog_id


/* To select Join both table ( transactionTable and TransactionItemTable and movieTable ) */

select * from 
 Transaction_tab t
JOIN TransactionItem ti
ON t.Transaction_ID=ti.Transaction_ID
JOIN movie m
ON ti.Catalog_id=m.Catalog_id
where Transaction_Type='rent'

/*Query 2 (View the average number of rental days per customer and per title ) */

/*(per customer) */
select t.Customer_ID,c.First_name+c.Minit+c.Last_name'FullName',(DATEDIFF(day,t.Transaction_Date,t.return_date)) 'Average Number of rental days'
from Transaction_tab t
JOIN Customer c
on t.Customer_ID=c.CustomerID
where rental_charge != 0
GROUP BY t.Customer_ID,C.First_name,C.Minit,C.Last_name,t.Transaction_Date,t.return_date
order by t.Customer_ID,c.First_name,C.Minit,C.Last_name,t.Transaction_Date,t.return_date


/* To select Join both table ( transactionTable and customerTable ) */

select * from 
Transaction_tab t 
JOIN Customer c 
on t.Customer_ID=c.CustomerID

/*(per title)*/
select t.Transaction_ID,ca.Catalog_id,m.Movie_name,(DATEDIFF(day,t.Transaction_Date,t.return_date)) 'Average Number of rental days'
from Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN movie m
on ca.Catalog_id=m.Catalog_id
where rental_charge != 0
GROUP BY t.Transaction_ID,ca.Catalog_id,m.Movie_name,t.Transaction_Date,t.return_date
order by t.Transaction_ID,ca.Catalog_id,m.Movie_name,t.Transaction_Date,t.return_date

/* To select Join both table ( transactionTable and TransactionItemTable and Catalog and movie  ) */

select * from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN movie m
on ca.Catalog_id=m.Catalog_id


/*Query 3 (View 10 most frequently reserved titles for last year) */
select t.Transaction_ID,ca.Catalog_id,m.Movie_name,t.Transaction_Date'Date',YEAR(t.Transaction_Date)'YEAR'
from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN movie m
on ca.Catalog_id=m.Catalog_id
where Transaction_Type='reserve' and YEAR(GETDATE()) > Year(DATEADD(YEAR,-1,Transaction_Date))
GROUP BY t.Transaction_ID,ca.Catalog_id,m.Movie_name,t.Transaction_Date
order by t.Transaction_ID,ca.Catalog_id,m.Movie_name,t.Transaction_Date


/* To select Join both table ( transactionTable and CustomerTable  and transactionItem table and catalog table ) */


select *
from Transaction_tab t
JOIN Customer ca
on t.Customer_ID=ca.CustomerID
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN catalog c
on ti.Catalog_id=c.Catalog_id


/*Query 4 (View  best customers in terms of money paid to the ) 
company */

select t.Transaction_ID,ca.CustomerID'Best Customer',c.Catalog_id,ca.First_name+ca.Minit+ca.Last_name'FullName',sum(rental_charge+penalty_charge)*c.chargeperday'Sum of money paid',TotalCharge*c.chargeperday'Total of Money paid'
from Transaction_tab t
JOIN Customer ca
on t.Customer_ID=ca.CustomerID
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN catalog c
on ti.Catalog_id=c.Catalog_id
GROUP BY t.Transaction_ID,ca.CustomerID,c.Catalog_id,ca.First_name,ca.Minit,ca.Last_name,t.TotalCharge,c.chargeperday
order by t.TotalCharge desc



/*Query 5 (View monthly revenue of the company for the 12 months ) */
select sum(t.rental_charge+t.penalty_Charge)*c.chargeperday'Total Revenue',sum(t.rental_charge)'Total of rental_charge without penaltycharge',sum(t.penalty_Charge)'Total of penalty_charge',sum(c.chargeperday)'Total Chargeperday',DATENAME(month,t.Transaction_Date) 'Month'
from Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Catalog c
on ti.Catalog_id=c.Catalog_id
WHERE YEAR(GETDATE()) > Year(DATEADD(YEAR,-1,Transaction_Date)) 
GROUP BY MONTH(Transaction_Date) ,TotalCharge,t.Transaction_ID,c.chargeperday,t.Transaction_Date
order by  MONTH(Transaction_Date)

/* To select Join both table ( transactionTable and TransactionItem and CustomerTable ) */

select *
from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Customer c
on t.Customer_ID=c.CustomerID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id


/*Query 6 (View the total amount of penalty incurred by each customer for
movies and equipment respectively ) */


/*View the total amount of penalty incurred by each customer for
movies*/
select c.CustomerID,c.First_name+c.Minit+c.Last_name'CustomerName',sum(t.penalty_Charge)'total of penalty charge',ca.Catalog_id,m.Movie_name
from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Customer c
on t.Customer_ID=c.CustomerID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN movie m
on ca.Catalog_id=m.Catalog_id
where penalty_Charge !=0
GROUP BY c.CustomerID,c.First_name+c.Minit+c.Last_name,t.penalty_Charge,ca.Catalog_id,m.Movie_name



/*View the total amount of penalty incurred by each customer for
vcr*/
select c.CustomerID,c.First_name+c.Minit+c.Last_name'CustomerName',sum(t.penalty_Charge)'total of penalty charge',ca.Catalog_id,vcr.VCR_brand
from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Customer c
on t.Customer_ID=c.CustomerID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN  VCR vcr
on ca.Catalog_id=vcr.Catalog_id
where penalty_Charge !=0
GROUP BY c.CustomerID,c.First_name+c.Minit+c.Last_name,t.penalty_Charge,ca.Catalog_id,vcr.VCR_brand



/*View the total amount of penalty incurred by each customer for
videoCamera*/
select c.CustomerID,c.First_name+c.Minit+c.Last_name'CustomerName',sum(t.penalty_Charge)'total of penalty charge',ca.Catalog_id,videocamera.Video_camera_brand
from 
Transaction_tab t
JOIN TransactionItem ti
on t.Transaction_ID=ti.Transaction_ID
JOIN Customer c
on t.Customer_ID=c.CustomerID
JOIN Catalog ca
on ti.Catalog_id=ca.Catalog_id
JOIN  VideoCamera videocamera
on ca.Catalog_id=videocamera.Catalog_id
where penalty_Charge !=0
GROUP BY c.CustomerID,c.First_name+c.Minit+c.Last_name,t.penalty_Charge,ca.Catalog_id,videocamera.Video_camera_brand